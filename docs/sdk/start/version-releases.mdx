---
title: TapSDK 更新日志
sidebar_position: 7
---

import CodeBlock from "@theme/CodeBlock";
import sdkVersions from "/src/docComponents/sdkVersions";
import { Conditional } from "/src/docComponents/conditional";

<!--
请在每个需要用户关注变化的 MR 中更新 Unreleased 部分。请按以下类型顺序组织变化：
### 重大变更
### 功能更新
### Bug 修复
### 优化
### 内部优化

在发布时请为 Unreleased 的变化添加一个合适的版本号标题并附加发布日期，并请务必保留空的 Unreleased section。
不同类型的区别以及版本号的选择请参考： https://xindong.atlassian.net/wiki/spaces/TDS/pages/723709064
-->

## TapSDK V-3.19.1
更新时间 2023-07-19

### Bug 修复
- **TapDB:** 修复 PC 平台解码缓存数据的 bug

### 优化
- **Billboard:** 优化 PC 平台公告面板模糊的问题（增加 WebView 渲染密度）

### 内部优化
- **Login:** 替换网页授权的域名

## TapSDK V-3.19.0
更新时间 2023-07-07

### 功能更新
- **TapPayment:** 支持微信和支付宝的 App 支付和微信支付，依赖 TapCommon 3.19.0 版本

### Bug 修复
- **AntiAddiction:** 修复手动实名窗口身份证输入框在部分设备上无法输入 X 的问题

### 内部优化
- **Common:** 新增对 TapPayment 的接口支持

## TapSDK V-3.18.9
更新时间 2023-06-30

### 优化
- **AntiAddiction:** 为优化因多次点击使用 Tap 认证导致的多次获取授权问题，在触发授权时添加 Loading 提示

### 功能更新
- **PaymentsGlobal:** 新增海外支付模块，为开发者在 TapTap 商店销售游戏以及在游戏内销售数字商品和内容提供最佳解决方案

## TapSDK V-3.18.8
更新时间 2023-06-15

### Bug 修复
- **Login:** 修复 TapTap 登录过程中，登录窗口短暂出现登录失败提示

### 优化
- **DB:** Android 添加对因 OAID 缺少对应平台架构 so 库文件而发生异常的捕获
- **AntiAddiction:** Android 为兼容 Java 1.8 及 Gradle 插件 4.0 以下低版本不支持 Lambda 表达式问题，将现有 Lambda 部分改为普通匿名类
- **Friend:** Android 为兼容 Java 1.8 及 Gradle 插件 4.0 以下低版本不支持 Lambda 表达式问题，将现有 Lambda 部分改为普通匿名类
- **Login:** PC 新增对印尼语，日语，韩语，泰语，中文繁体的语言支持

### 内部优化
- **Common:** Android 添加在 TapSDK 初始化完成后支持通过 ContentProvider 方式获取 TapConfig 中 clientToken 及 serverUrl 字段


## TapSDK V-3.18.7
更新时间 2023-05-25

### Bug 修复
- **AntiAddiction:** 修复 Android 个别机型防沉迷提示窗无法完全展示问题

### 优化
- **DB:** 支持新版 CAID 接口


## TapSDK V-3.18.6
更新时间 2023-04-27

### Bug 修复
- **AntiAddiction:** 修复部分情况下取消授权后页面无法消失的问题

### 优化
- **Support:** 打开的客服页面支持多语言适配
- **Achievement:** 延长网络超时到 10s
- **Achievement:** 优化部分错误信息的解析
- **DB:** 优化缓存文件读写次数
- **Moment:** 优化旋转逻辑
- **Common:** 删减 LZ4 中不必要的架构支持


## TapSDK V-3.18.5
更新时间 2023-04-10

### 功能更新
- **Common:** 添加应用配置数据封装
- **DB:** TapDB 新增设备属性
- **DB:** 添加设备标识数据封装
- **Login:** 添加用户信息数据封装


## TapSDK V-3.18.5-1
更新时间 2023-04-20

### 优化
- **DB:** 优化语言设置


## TapSDK V-3.18.4
更新时间 2023-03-30

### 功能更新
- **DB:** PC 接口重写
- **DB:** TapDB 新增接口控制是否使用 Themis
- **DB:** Themis 更新
- **License:** 新增接口支持跳过缓存强制检查购买状态

### Bug 修复
- **DB:** TapDB 不再获取 ipv6 地址
- **DB:** TapDB 版本号改为 TapSDK 版本号


## TapSDK V-3.18.3
更新时间 2023-03-23

### Bug 修复
- **AntiAddiction:** 修复 iOS 无回调的异常


## TapSDK V-3.18.2
更新时间 2023-03-20

### 功能更新
- **AntiAddiction:** 更新防沉迷认证接口
- **Achievement:** UI 适配大屏设备
- **Achievement:** 支持 PC 版本

### Bug 修复
- **AntiAddiction:** 修复提示 UI 错位问题 
- **AntiAddiction:** 修复iOS 部分情况下进入宵禁未弹出提示异常
- **DB:** 默认关闭从 TapTap 获取 device id


## TapSDK V-3.18.1
更新时间 2023-03-06

### 功能更新
- **DB:** 添加网络重定向支持

### Bug 修复
- **Payment:** 修复用户支付主动取消时没有回调的异常
- **Support:** 修复断网重连时点击重试白屏的问题
- **Billboard:** 修复 Unity 打包时配置问题
- **Billboard:** 修复初始化接口异常


## TapSDK V-3.18.0
更新时间 2023-02-20

### 功能更新
- **Support:** 支持自有账户关联登录
- **Support:** 支持 TDS 内建账户登录
- **Support:** 优化客服接口


## TapSDK V-3.17.0
更新时间 2023-02-17

### 功能更新
- **Billboard:** 添加跑马灯及开屏公告

### 优化
- **DB:** 优化设备兼容性


## TapSDK V-3.16.6
更新时间 2023-01-06

### Bug 修复
- **AntiAddiction:** 修复 Unity Android 多 Activity 下，退出游戏有可能重启的 bug


## TapSDK V-3.16.5
更新时间 2022-12-05

### 功能更新
- **DB:** 添加设备时长上报

### 优化
- **AntiAddiction:** 添加平台兼容性处理
- **Payment:** 优化设备 ID 获取处理


## TapSDK V-3.16.4
更新时间 2022-11-17

### 功能更新
- **DB:** 更新上报域名及数据格式
- **Login:** 修改网页登录 UI 显示
- **AntiAddiction:** 添加沙盒内实名流程优化

### Bug 修复
- **Login:** 修复部分情况资格验证回调异常
- **Bootstrap:** 修复设备启动或网络状态更新时触发推送服务


## TapSDK V-3.16.2
更新时间 2022-11-01

### 功能更新
- **Support:** 新增 SDK 内打开客服页面的能力
- **DB:** iOS 支持 CAID 归因


## TapSDK V-3.16.1
更新时间 2022-10-17

更新日志


### 功能更新
- **Billboard:** 添加关闭按钮事件回调
- **Billboard:** 优化网络异常时 UI 显示
- **Friend:** 添加数据埋点支持
- **DB:** 支持接口设置 OAID 应用包密匙

### Bug 修复
- **Billboard:** 修复 iOS 16 兼容性问题


## TapSDK V-3.16.0
更新时间 2022-09-30

### 功能更新
- **Payment:** 支持海外支付

### Bug 修复
- **AntiAddiction:** 修复upm导入错误的问题

### 优化
- **DB:** TapDB iOS 支持识别 Arm 芯片的 Mac


## TapSDK V-3.15.1
更新时间 2022-09-15

### 功能更新
- **Common:** 增加防沉迷依赖的UI模块

### Bug 修复
- **AntiAddiction:** 修复缺少UI模块导致的编译错误（UI模块已经移入Common库）


## TapSDK V-3.15.0
更新时间 2022-09-13

Warning: 该版本的防沉迷，请先别使用此版本。

### Bug 修复
- **Achievement:** 修复成就 Android SDK 在 Android 12 上首次初始化失败的问题

### 优化
- **AntiAddiction:** 防沉迷接口优化
- **DB:** Android SDK 新版OAID适配
- **Login:** 优化登录 Android SDK 内不必要的错误日志


## TapSDK V-3.14.0
更新时间 2022-08-25

### 功能更新
- **Themis:** 新增异常上报模块

### Bug 修复
- **DB:** TapDB 增加Themis 支持


## TapSDK V-3.13.0
更新时间 2022-08-18

### 功能更新
- **Login:** iOS 和 Android Tap 登录支持新的 scope （basic_info & email）
- **Login:** iOS 有端 Tap 登录协议升级

### Bug 修复
- **Login:** Android Tap 登录修复一些特殊情况下的崩溃（增加了 null 检查避免NPE）


## TapSDK V-3.12.1
更新时间 2022-08-09

### Bug 修复
- **Common:** 修复TapSDK初始化时未传公告参数产生的NPE


## TapSDK V-3.12.0
更新时间 2022-08-04

Danger: TapBootstrap 初始化时会产生空指针异常，请先别使用此版本。


### 功能更新
- **Billboard:** 新增公告模块

### Bug 修复
- **Payment:** 修复支付窗口旋转后crash问题


## TapSDK V-3.11.1
更新时间 2022-07-25

### Bug 修复
- **Login:** 修复 iOS 登录模块对系统 URL 回调的使用方式
- **Common:** 修复 iOS 授权模块对系统 URL 回调的使用方式

### 优化
- **Friend:** 更新获取 Tap 互关好友的方式


## TapSDK V-3.11.0
更新时间 2022-07-12

### Bug 修复
- **Achievement:** 修复桥接部分解析的问题
- **DB:** 桥接传入参数为null的兼容处理
- **DB:** 接口优化
- **AntiAddiction:** iOS平台 传入的userId包含特殊字符时的兼容处理


## TapSDK V-3.9.0
更新时间 2022-05-25

### 功能更新
- **Payment:** Android提供国内支付服务(内测中)

### Bug 修复
- **Common:** iOS屏蔽了日志的后台任务,避免出现crash
- **LeanCloud:** 更新至 0.10.11 [地址](https://github.com/leancloud/csharp-sdk/releases/tag/0.10.11)

### 优化
- **Moment:** 动态SDK本地多语言资源适配


## TapSDK V-3.8.0
更新时间 2022-05-09

### 功能更新
- **Friend:** 添加好友模式黑名单

### Bug 修复
- **AntiAddiction:** 修复iOS本地缓存的配置错误，并且优化了配置缓存逻辑

### 优化
- **Moment:** 优化授权请求逻辑
- **LeanCloud:** 更新至 0.10.10 [地址](https://github.com/leancloud/csharp-sdk/releases/tag/0.10.10)


## TapSDK V-3.7.1
更新时间 2022-04-11

### 功能更新
- **DB:** 增加开机时间的获取和上报

### Bug 修复
- **Moment:** 动态旋转问题的修复

### 优化
- **AntiAddiction:** 优化从主站授权的逻辑


## TapSDK V-3.7.0
更新时间 2022-03-28

### Bug 修复
- **Friend:** 分享链接支持自定义用户名称及配置额外自定义参数
- **Friend:** 添加解析及处理分享链接接口
- **Friend:** 添加关注模式下黑名单相关接口
- **Friend:** 好友请求数据中添加对方富信息数据
- **Friend:** 支持根据用户 ID 查找用户信息
- **Login:** 添加获取互关好友列表接口


## TapSDK V-3.6.3
更新时间 2022-03-08

### 功能更新
- **DB:** 当初始化地区为海外时，使用海外上报域名
- **DB:** iOS 当结束进程时上报游玩时长失败后，再次打开会尝试重新上报时长（如果之前已接入数据分析功能，且初始化地区为海外，升级 SDK 至 3.6.3 前需迁移数据，请提交工单联系我们）
- **DB:** iOS 内部版本更新到3.0.9

### Bug 修复
- **Bootstrap:** Android LCPush 的 receiver exported 参数改为 true 以适配 Android 12
- **Achievement:** 成就面板在稀有度为0时不显示稀有度对应文案
- **Achievement:** Android 资源使用改为R文件引用
- **Login:** Android 尝试修复静态变量丢失的问题
- **Login:** Android 资源使用改为R文件引用
- **Moment:** Android 修复某些机型上会触发 getDialog 相关的 NPE 问题
- **Moment:** iOS 提供可供切换到 Controller 模式展示UI的 api
- **Common:** Android 修复特定机型上繁体中文的识别
- **Common:** Android 修复初始化时未配置 TapDBConfig 会初始化失败的问题
- **AntiAddiction:** 提升防沉迷服务异常情况下的用户体验


## TapSDK V-3.6.1
更新时间 2022-02-07

### Bug 修复
- **RTC:** RTC 接口优化
- **Login:** 登陆 UI 优化
- **Moment:** 内嵌动态支持多语言上报
- **AntiAddiction:** 实名认证接口移除参数TapToken


## TapSDK V-3.6.0
更新时间 2022-01-07

### 功能更新
- **Friend:** 支持获取 Tap 及游戏内单向关注模型好友列表

### Bug 修复
- **License:** DLC 修复在查询回调内直接发起购买请求后无法获得购买回调的问题


## TapSDK V-3.5.0
更新时间 2021-11-30

### Bug 修复
- **RTC:** 修复范围语音失效问题
- **Friend:** 根据好友码查找好友
- **Friend:** 根据好友码添加好友
- **Friend:** 查询第三方好友列表
- **Friend:** 关注 TapTap 好友
- **Achievement:** 修复读取本地数据已达成成就识别成未达成的问题
- **Login:** 内嵌 web 登录页面支持异形刘海屏的正常展示
- **DB:** 上报新增 soc 相关参数
- **Moment:** 依赖更新
- **Common:** 支持性更新
- **AntiAddiction:** 防沉迷服务端异常时增加兼容处理
- **AntiAddiction:** 切换账号可隐藏
- **AntiAddiction:** 更新切换账号的回调 code （from 1000 -> 1001）


## TapSDK V-3.4.0
更新时间 2021-11-09

### 功能更新
- **RTC:** 新增即时语音通话
- **DB:** 修改部分上报参数及修复时长统计问题


## TapSDK V-3.3.1
更新时间 2021-10-25

### 功能更新
- **Friend:** 好友新增多语言支持
- **Friend:** 从分享页跳转到应用内且发送好友申请时，从提示改为回调。

### Bug 修复
- **DB:** 修复上报地址错误
- **AntiAddiction:** Api 增加公用参数


## TapSDK V-3.3.0
更新时间 2021-10-15

### 功能更新
- **Support:** 新增客服模块
- **Friend:** 新增好友模块
- **AntiAddiction:** 新增防沉迷模块

### Bug 修复
- **Achievement:** UI 调整
- **Moment:** 优化统计参数


## TapSDK V-3.2.0
更新时间 2021-09-01

### 重大变更
- **Bootstrap:** 迁移 `RegionType.cs` 、`TapConfig.cs` 至 `TapCommon` 模块

### 功能更新
- **Bootstrap:** 支持云存档
- **Login:** 新增 PC 端支持
- **DB:** Android TapDB 支持沙盒上报
- **DB:** iOS 支持ASA
- **DB:** iOS 删除多余的上报参数（appId）

### Bug 修复
- **Moment:** 修复动态内登录后没有回调的问题
- **Moment:** iOS 优化动态多次打开后的内存占用


## TapSDK V-3.1.0
更新时间 2021-07-28

### 功能更新
- **Bootstrap:** 支持游戏内好友
- **Achievement:** 支持游戏内成就

### Bug 修复
- **Moment:** 修复在 Android 11 的设备上没有特定权限时打开动态会崩溃的问题
- **License:** 修复正版验证在某些情况下会在验证成功后崩溃的问题


## TapSDK V-3.0.0
更新时间 2021-07-16

Tips: 当前版本不支持 v2.x 升级

### 重大变更
- **Bootstrap:** 账号系统升级为TDSUser
- **Bootstrap:** 登录相关接口修改
- **Bootstrap:** 获取篝火资格接口移动至 TapLogin 模块
- **Bootstrap:** 删除设置语言接口
- **Login:** 开放所有接口，支持获取 TapTap 账号的 openID 和 unionID

### Bug 修复
- **Moment:** 修复一个可能导致页面崩溃的 bug


## TapSDK V-2.1.8
更新时间 2021-07-21

### Bug 修复
- **Moment:** 修复在 Android 11 的设备上没有特定权限时打开动态会崩溃的问题
- **License:** 修复正版验证在某些情况下会在验证成功后崩溃的问题


## TapSDK V-2.1.7
更新时间 2021-07-14

### 功能更新
- **DB:** TapDB 充值接口新增支持传入自定义字段的函数

### 优化
- **Friend:** TapLogin 以及 TapFriends 修改 iOS openUrl 拦截方式


## TapSDK V-2.1.6
更新时间 2021-07-01

### Bug 修复
- **Moment:** 修复调用 [TapMoment close] 不生效的 bug


## TapSDK V-2.1.5
更新时间 2021-06-22

### 功能更新
- **Moment:** 新增场景化回调接口
  
  ```
  //场景化回调是在动态回调的统一接口中返回，Code = 70000，内容为 JSON 格式的字符串
  {
    sceneId: "taprl0071417002",
    eventType: "READY",
    eventPayload: "{}",
    timestamp: 1622791814130, // ms
  }
  ```
- **DB:** Android 新增游戏 TapTap 共享ID 开关
- **Login:** 云玩内唤起 TapTap 客户端登陆


## TapSDK V-2.1.4
更新时间 2021-06-10

### 功能更新
- **Friend:** 新增设置富信息和查询富信息接口
- **Friend:** TapUserRelationShip 新增 online & time & TapRichPresence 参数

### Bug 修复
- **Bootstrap:** 内部优化
- **Common:** 优化多语言相关
- **Common:** 修复 JSON 解析问题


## TapSDK V-2.1.3
更新时间 2021-06-03

### 功能更新
- **Bootstrap:** 新增繁中、日文、韩文、泰文和印尼语多语言配置
- **Common:** iOS 新增 TapTap 以及 Tap.IO 客户端安装判断

### Bug 修复
- **Friend:** 修复特殊场景下，好友可能会弹窗多次
- **Moment:** Android 在部分刘海屏设备上判断失败导致UI可能被遮挡的问题


## TapSDK V-2.1.2
更新时间 2021-05-18

### 重大变更
- **Bootstrap:** 废弃 OpenUserCenter 接口

### 功能更新
- **Friend:** 新增消息回调接口
  ```c#
  TapFriends.RegisterMessageListener(ITapMessageListener listener);
  ```  
- **Friend:** 搜索好友
    ```c#
    TapFriends.SearchUser(string userId, Action<TapUserRelationShip, TapError> action)
    ```  
- **Friend:** 分享好友邀请
  ```c#
  TapFriends.SendFriendInvitation(Action<bool, TapError> action);
  ```
- **Friend:** 获取好友邀请链接
  ```c#
  TapFriends.GenerateFriendInvitation(Action<string, TapError> action);
  ```
- **Friend:** 新增 TapFriends UI

### Bug 修复
- **Common:** 修复 iOS ALWAYS_EMBED_SWIFT_STANDARD_LIBRARIES 设置问题可能导致的 AppStore 审核无法通过


## TapSDK V-2.1.1
更新时间 2021-05-11

### 重大变更
- **Bootstrap:** LoginType 删除 Apple、Guest 登陆方式
- **Bootstrap:** TDS-Info.plist 删除 Apple_SignIn_Enable 配置
- **Bootstrap:** 废弃 Bind 接口
- **Bootstrap:** TapConfig 构造方法参数修改

### 功能更新
- **Common:** Android 新增 TapTap App 相关支持功能
- **Common:** 新增长链接支持 TapTap.Friends
- **Common:** 海内外域名切换
- **Bootstrap:** 新增篝火测试资格校验
    ```
  TapBootstrap.GetTestQualification((bool, error)=>{ }):
    ```
- **Bootstrap:** 通过 TapConfig 进行初始化配置
  * 新增 TapDBConfig 用于 TapDB 初始化配置
  * 新增 ClientSecret 用于 TapSDK 初始化
    ```c#
    //建议使用以下 TapConfig 构造方法进行初始化
    var config = new TapConfig.Builder()
                  .ClientID("client_id")
                  .ClientSecret("client_secret")
                  .RegionType(RegionType.CN)
                  .TapDBConfig(true, "gameChannel", "gameVersion", true)
                  .ConfigBuilder();
    TapBootstrap.Init(config);
    ```
- **Friend:** 新增 Tap 好友服务
- **License:** 新增 DLC 购买认证服务
- **Moment:** 新增 DirectlyOpen 接口
    * 场景化入口
      ```c#
      var sceneDic = new Dictionary<string,object>(){{TapMomentConstants.TapMomentPageShortCutKey,sceneId}};
    
      TapMoment.DirectlyOpen(orientation,TapMomentConstants.TapMomentPageShortCut,sceneDic);
      ```
- **DB:** 新增 RegisterDynamicProperties 接口
- **DB:** 新增 AdvertiserIDCollectionEnabled IDFA 获取开关


## TapSDK V-2.0.0
更新时间 2021-04-08

[TapSDK 开发者中心](https://developer.taptap.com/v2-doc/sdk)